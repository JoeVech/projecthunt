<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AR –ó–≤–µ—Ä–∏</title>
    
    <!-- –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π CSP –¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ -->
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self' 'unsafe-inline' data: blob:;
        script-src 'self' 'unsafe-inline' 'unsafe-eval';
        style-src 'self' 'unsafe-inline';
    ">

    <!-- –°—Ç–∏–ª–∏ -->
    <link rel="stylesheet" href="/css/main.css">

    <!-- –õ–æ–∫–∞–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã -->
    <script src="/js/aframe.min.js"></script>
    <script src="/js/aframe-ar-nft.min.js"></script>
    <script src="/js/telegram-web-app.js"></script>
</head>
<body>
    <!-- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div class="loader">
        <button id="startButton" class="tg-button">
            <span class="button-text">üöÄ –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å AR</span>
            <div class="loading-spinner hidden"></div>
        </button>
        <div id="status" class="status-text">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è –Ω–∞—á–∞–ª–∞</div>
    </div>

    <!-- AR-—Å—Ü–µ–Ω–∞ (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç–∞) -->
    <a-scene 
        vr-mode-ui="enabled: false"
        arjs="sourceType: webcam; debugUIEnabled: false; trackingMethod: best;"
        renderer="logarithmicDepthBuffer: true;"
        class="hidden"
    >
        <a-camera gps-camera rotation-reader></a-camera>
        <a-entity id="animal" arjs-anchor="detectedPlanes: true;" visible="false">
            <a-box position="0 0.5 0" color="#4CAF50" scale="0.5 0.5 0.5"></a-box>
            <a-text value="ü¶ä –î–∏–∫–∏–π –∑–≤–µ—Ä—å!" position="0 1.2 0" align="center" color="#FFF"></a-text>
            <a-animation attribute="rotation" to="0 360 0" dur="5000" repeat="indefinite"></a-animation>
        </a-entity>
    </a-scene>

    <!-- –û—Å–Ω–æ–≤–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã -->
    <script src="/js/ar-config.js"></script>
    <script src="/js/app.js"></script>

    <!-- Fallback –¥–ª—è –æ—à–∏–±–æ–∫ -->
    <script>
        window.addEventListener('error', (e) => {
            document.body.innerHTML = `
                <div class="error-overlay">
                    <div class="error-content">
                        <h2>‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞</h2>
                        <p>${e.message}</p>
                        <button onclick="location.reload()">‚ü≥ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å</button>
                    </div>
                </div>
            `;
        });
    </script>
</body>
</html>
