<!DOCTYPE html>
<html>
<head>
    <title>AR Camera Debug</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script>
        // Блокировка Web3-расширений
        window.addEventListener('load', () => {
            delete window.ethereum;
            delete window.web3;
            console.log('Web3 extensions blocked');
        });
    </script>
    <style>
        body { margin: 0; overflow: hidden; }
        #status {
            position: fixed;
            top: 10px;
            left: 10px;
            color: white;
            font-family: Arial;
            z-index: 1000;
            background: rgba(0,0,0,0.7);
            padding: 10px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div id="status">Инициализация...</div>
    <a-scene embedded arjs="debugUIEnabled: true">
        <a-camera></a-camera>
    </a-scene>

    <!-- Локальные версии библиотек -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aframe/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@ar-js-org/ar.js@3.4.0/aframe/build/aframe-ar.min.js"></script>

    <script>
        const status = document.getElementById('status');
        const scene = document.querySelector('a-scene');

        // Шаг 1: Проверка загрузки библиотек
        console.log('AFrame version:', AFRAME.version);
        console.log('AR.js version:', ARjs.version);
        status.innerHTML += '<br>Библиотеки загружены';

        // Шаг 2: Инициализация сцены
        scene.addEventListener('loaded', () => {
            console.log('Scene loaded');
            status.innerHTML += '<br>Сцена инициализирована';
            
            // Шаг 3: Получение видео элемента
            const video = document.querySelector('[arjs-video]');
            if (video) {
                console.log('Video element found');
                video.style.position = 'fixed';
                video.style.top = '0';
                video.style.left = '0';
                video.style.width = '100%';
                video.style.height = '100%';
                status.innerHTML += '<br>Видео настроено';
            } else {
                status.innerHTML += '<br>Ошибка: видео не найдено';
            }
        });

        // Шаг 4: Обработка ошибок
        scene.addEventListener('arjs-video-error', (error) => {
            console.error('AR.js Error:', error.detail.error);
            status.innerHTML += `<br>Ошибка: ${error.detail.error.message}`;
        });

        // Шаг 5: Проверка поддержки
        if (!AFRAME.utils.isWebXRAvailable()) {
            status.innerHTML += '<br>WebXR не поддерживается';
        }

        // Интеграция с Telegram
        if (typeof Telegram !== 'undefined') {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();
            console.log('Telegram WebApp initialized');
        }
    </script>
</body>
</html>
